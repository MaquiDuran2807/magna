import{Q as j,v as x,w as N,x as v,y as p,j as e,L as f,r as d,R as P,_ as b}from"./index-e183d08d.js";import{B as y,S as B,f as R,a as S}from"./sidebarBolgs-82cb03dd.js";import{a as w}from"./index.esm-8c98af6d.js";import{u as F}from"./useLazyload-11af7c3a.js";import"./footer1-8551e831.js";import"./index.esm-7087b389.js";import"./iconBase-5a6e9e1a.js";import"./index.esm-d1884518.js";import"./index.esm-19ea8574.js";var M=class extends j{constructor(s,t){super(s,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(s,t){super.setOptions({...s,behavior:x()},t)}getOptimisticResult(s){return s.behavior=x(),super.getOptimisticResult(s)}fetchNextPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"backward"}}})}createResult(s,t){var n,o,g,r;const{state:a}=s,c=super.createResult(s,t),{isFetching:i,isRefetching:l}=c,h=i&&((o=(n=a.fetchMeta)==null?void 0:n.fetchMore)==null?void 0:o.direction)==="forward",m=i&&((r=(g=a.fetchMeta)==null?void 0:g.fetchMore)==null?void 0:r.direction)==="backward";return{...c,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:N(t,a.data),hasPreviousPage:v(t,a.data),isFetchingNextPage:h,isFetchingPreviousPage:m,isRefetching:l&&!h&&!m}}};function L(s,t){return p(s,M,t)}const O=({blogs:s,search:t})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",children:[t&&t.length===0&&e.jsx("h3",{children:"No se encontraron resultados"}),t&&t.length>0&&e.jsx("h3",{children:"Resultados de la búsqueda"}),t&&(t==null?void 0:t.map(a=>e.jsx("div",{className:"col-lg-4 col-md-4 col-sm-6 ",children:e.jsx(f,{to:`/blog/${a.id}`,className:"link-blogs",children:e.jsxs("div",{className:"card card-blog mt-3 small-card",children:[e.jsx("div",{className:"card-img-top",children:e.jsx("img",{src:a.image,className:"img-fluid small-image",alt:a.title})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:a.title}),e.jsxs("p",{className:"card-text",children:[a.description.slice(0,200),"..."]})]})]})})},a.id))),t&&t.length>0&&e.jsx("hr",{className:"mt-5"})]}),e.jsx("div",{className:"row",children:s.map(a=>{let c="",i="",l="";return a.important===!1?(c="col-lg-4 col-md-4 col-sm-6",l="small-card",i="small-image"):a.important===!0?(c="col-lg-6 col-md-12 col-sm-12 ",i="big-image",l="big-card"):(c="col-lg-3 col-md-4 col-sm-6",i="small-image",l="small-card"),e.jsx("div",{className:c,children:e.jsx(f,{to:`/blog/${a.id}`,className:"link-blogs",children:e.jsxs("div",{className:`card card-blog mt-3 ${l}`,children:[e.jsx("div",{className:"card-img-top",children:e.jsx("img",{src:a.image,className:` img-fluid ${i}`,alt:a.title})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:a.title}),e.jsxs("p",{className:"card-text",children:[a.description.slice(0,200),"..."]})]})]})})},a.id)})})]}),E=({setFilter:s})=>{const[t,a]=d.useState(""),c=i=>{a(i.target.value),s(i.target.value)};return e.jsxs("div",{children:[e.jsx("input",{type:"text",value:t,onChange:c,placeholder:"Buscar...",className:"blog-search"}),e.jsx(w,{className:"ms-2"})]})},_=P.lazy(()=>b(()=>import("./index-e183d08d.js").then(s=>s.aa),["assets/index-e183d08d.js","assets/index-9f47fd08.css"])),C=()=>{const[s,t]=d.useState(""),[a,c]=d.useState(null),{data:i,isError:l,isLoading:h,fetchNextPage:m,hasNextPage:n,isFetchingNextPage:o}=L({queryKey:["blogs"],queryFn:({pageParam:r=0})=>S(r),initialPageParam:"1",staleTime:1e3*60*30,refetchOnWindowFocus:!1,refetchInterval:1e3*60*30,getNextPageParam:r=>{if(console.log(r,"lastPage"),r!=null&&r.nextPage)return console.log(r.nextPage,"lastPage.nextPage"),r.nextPage.split("=")[1]}});if(d.useEffect(()=>{if(!s)return;(async()=>{const u=await R(s);u&&c(u)})()},[s]),d.useEffect(()=>{i&&i.pages[0]&&console.log(i.pages[0].blogs,"data.pages[0].blogs")},[]),l)return e.jsx("div",{children:"Error"});if(h)return e.jsx(_,{});if(console.log(i,"data"),!i)return;const g=i.pages.flatMap(r=>(r==null?void 0:r.blogs)??[]);return e.jsx("div",{className:"blog-container pt-3",children:e.jsx(y,{children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"blog-header  text-center",children:e.jsx("h1",{children:"MagnaBlog"})}),e.jsx("div",{className:" text-center",children:e.jsx(E,{setFilter:t})}),e.jsxs("div",{className:"blog-cards ",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-8 col-12",children:e.jsx(O,{blogs:g,search:a})}),e.jsx("div",{className:"col-md-4 col-12",children:e.jsx(B,{})})]}),e.jsx("button",{onClick:()=>m(),className:"btn btn-primary",type:"button",disabled:!n||o,style:{marginTop:"2rem"},children:o?"Loading more...":n?"Cargar más blogs":"No hay más blogs"})]})]})})})};function A(){const{isVisible:s,ref:t}=F("100px");return e.jsx("div",{id:"LazyBlog",ref:t,children:s?e.jsx(C,{}):null})}export{A as default};


//# sourceMappingURL=data:application/json;base64,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LEVBQU0sTUFBTSxFQUNwQixDQUFDQSxFQUNELE9BR0UsTUFBQTFCLEVBQWtCMEIsRUFBSyxNQUFNLFFBQVNVLElBQVNBLEdBQUEsWUFBQUEsRUFBTSxRQUFTLEVBQUUsRUFFbEUsT0FBQWhDLE1BQUMsT0FBSSxVQUFVLHNCQUNYLGVBQUNpQyxFQUNHLFVBQUFuQyxPQUFDLE1BQUksV0FBVSxrQkFDWCxVQUFBRSxNQUFDLE9BQUksVUFBVSwyQkFDWCxTQUFDQSxNQUFBLE1BQUcscUJBQVMsQ0FDakIsU0FDQyxNQUFJLFdBQVUsZUFDWCxTQUFDQSxFQUFBLElBQUFrQyxFQUFBLENBQVcsVUFBQTNCLENBQXNCLEdBQ3RDLEVBQ0FULE9BQUMsTUFBSSxXQUFVLGNBQ1gsVUFBQ0EsT0FBQSxPQUFJLFVBQVUsTUFDWCxVQUFDRSxNQUFBLE9BQUksVUFBVSxrQkFDWCxTQUFBQSxNQUFDTCxHQUFTLE1BQUFDLEVBQWMsT0FBUXdCLEVBQWEsQ0FDakQsU0FDQyxNQUFJLFdBQVUsa0JBQ1gsU0FBQXBCLE1BQUNtQyxHQUFRLEdBQ2IsR0FDSixFQUNBbkMsRUFBQSxJQUFDLFVBQ0wsUUFBUyxJQUFNeUIsRUFBYyxFQUM3QixVQUFVLGtCQUNWLEtBQUssU0FDTCxTQUFVLENBQUNuQyxHQUFlTixFQUMxQixNQUFPLENBQUUsVUFBVyxNQUFPLEVBRTFCLFNBQUFBLEVBQ0ssa0JBQ0FNLEVBQ0EsbUJBQ0EsbUJBQ1YsR0FDSSxHQUNKLEVBQ0osQ0FDSixFQUVSLEVBRUEsU0FBd0I4QyxHQUFXLENBQy9CLEtBQU0sQ0FBRyxVQUFBQyxFQUFXLElBQUFDLENBQUksRUFBSUMsRUFBd0IsT0FBTyxFQUV2RCxPQUFBdkMsRUFBQSxJQUFDLE9BQUksR0FBRyxXQUFXLElBQUFzQyxFQUNkLFNBQVlELEVBQUFyQyxFQUFBLElBQUNrQixFQUFLLElBQUssSUFDNUIsRUFFUiIsIm5hbWVzIjpbIkluZmluaXRlUXVlcnlPYnNlcnZlciIsIlF1ZXJ5T2JzZXJ2ZXIiLCJjbGllbnQiLCJvcHRpb25zIiwibm90aWZ5T3B0aW9ucyIsImluZmluaXRlUXVlcnlCZWhhdmlvciIsInF1ZXJ5Iiwic3RhdGUiLCJyZXN1bHQiLCJpc0ZldGNoaW5nIiwiaXNSZWZldGNoaW5nIiwiaXNGZXRjaGluZ05leHRQYWdlIiwiX2IiLCJfYSIsImlzRmV0Y2hpbmdQcmV2aW91c1BhZ2UiLCJfZCIsIl9jIiwiaGFzTmV4dFBhZ2UiLCJoYXNQcmV2aW91c1BhZ2UiLCJ1c2VJbmZpbml0ZVF1ZXJ5IiwicXVlcnlDbGllbnQiLCJ1c2VCYXNlUXVlcnkiLCJCbG9nTGlzdCIsImJsb2dzIiwic2VhcmNoIiwianN4cyIsIkZyYWdtZW50IiwianN4IiwiYmxvZyIsIkxpbmsiLCJzaXplQ2xhc3MiLCJpbWFnZUNsYXNzIiwiY2FyZENsYXNzIiwiU2VhcmNoIiwic2V0RmlsdGVyIiwic2VhcmNoVmFsdWUiLCJzZXRTZWFyY2hWYWx1ZSIsInVzZVN0YXRlIiwiaGFuZGxlU2VhcmNoQ2hhbmdlIiwiZXZlbnQiLCJGaVNlYXJjaCIsIlNwaW5uZXIiLCJSZWFjdCIsIl9fdml0ZVByZWxvYWQiLCJuIiwiQmxvZyIsImZpbHRlciIsImZpbHRlckJsb2dzIiwic2V0RmlsdGVyQmxvZ3N0IiwiZGF0YSIsImlzRXJyb3IiLCJpc0xvYWRpbmciLCJmZXRjaE5leHRQYWdlIiwicGFnZVBhcmFtIiwiZmV0Y2hOZXh0QmxvZ3MiLCJsYXN0UGFnZSIsInVzZUVmZmVjdCIsInJlc3BvbnNlIiwiZmV0Y2hCbG9nU2VhcmNoIiwicGFnZSIsIkJsb2dMYXlvdXQiLCJCbG9nU2VhcmNoIiwiU2lkZWJhciIsIkxhenlCbG9nIiwiaXNWaXNpYmxlIiwicmVmIiwidXNlSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiXSwic291cmNlcyI6WyIuLi8uLi9ub2RlX21vZHVsZXMvQHRhbnN0YWNrL3F1ZXJ5LWNvcmUvYnVpbGQvbW9kZXJuL2luZmluaXRlUXVlcnlPYnNlcnZlci5qcyIsIi4uLy4uL25vZGVfbW9kdWxlcy9AdGFuc3RhY2svcmVhY3QtcXVlcnkvYnVpbGQvbW9kZXJuL3VzZUluZmluaXRlUXVlcnkuanMiLCIuLi8uLi9zcmMvY29tcG9uZW50cy9ibG9nQ2FyZHMudHN4IiwiLi4vLi4vc3JjL2NvbXBvbmVudHMvc2VhcmNoLnRzeCIsIi4uLy4uL3NyYy9wYWdlcy9ibG9nLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvaW5maW5pdGVRdWVyeU9ic2VydmVyLnRzXG5pbXBvcnQgeyBRdWVyeU9ic2VydmVyIH0gZnJvbSBcIi4vcXVlcnlPYnNlcnZlci5qc1wiO1xuaW1wb3J0IHtcbiAgaGFzTmV4dFBhZ2UsXG4gIGhhc1ByZXZpb3VzUGFnZSxcbiAgaW5maW5pdGVRdWVyeUJlaGF2aW9yXG59IGZyb20gXCIuL2luZmluaXRlUXVlcnlCZWhhdmlvci5qc1wiO1xudmFyIEluZmluaXRlUXVlcnlPYnNlcnZlciA9IGNsYXNzIGV4dGVuZHMgUXVlcnlPYnNlcnZlciB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdXNlbGVzcy1jb25zdHJ1Y3RvclxuICBjb25zdHJ1Y3RvcihjbGllbnQsIG9wdGlvbnMpIHtcbiAgICBzdXBlcihjbGllbnQsIG9wdGlvbnMpO1xuICB9XG4gIGJpbmRNZXRob2RzKCkge1xuICAgIHN1cGVyLmJpbmRNZXRob2RzKCk7XG4gICAgdGhpcy5mZXRjaE5leHRQYWdlID0gdGhpcy5mZXRjaE5leHRQYWdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5mZXRjaFByZXZpb3VzUGFnZSA9IHRoaXMuZmV0Y2hQcmV2aW91c1BhZ2UuYmluZCh0aGlzKTtcbiAgfVxuICBzZXRPcHRpb25zKG9wdGlvbnMsIG5vdGlmeU9wdGlvbnMpIHtcbiAgICBzdXBlci5zZXRPcHRpb25zKFxuICAgICAge1xuICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICBiZWhhdmlvcjogaW5maW5pdGVRdWVyeUJlaGF2aW9yKClcbiAgICAgIH0sXG4gICAgICBub3RpZnlPcHRpb25zXG4gICAgKTtcbiAgfVxuICBnZXRPcHRpbWlzdGljUmVzdWx0KG9wdGlvbnMpIHtcbiAgICBvcHRpb25zLmJlaGF2aW9yID0gaW5maW5pdGVRdWVyeUJlaGF2aW9yKCk7XG4gICAgcmV0dXJuIHN1cGVyLmdldE9wdGltaXN0aWNSZXN1bHQob3B0aW9ucyk7XG4gIH1cbiAgZmV0Y2hOZXh0UGFnZShvcHRpb25zKSB7XG4gICAgcmV0dXJuIHRoaXMuZmV0Y2goe1xuICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIG1ldGE6IHtcbiAgICAgICAgZmV0Y2hNb3JlOiB7IGRpcmVjdGlvbjogXCJmb3J3YXJkXCIgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGZldGNoUHJldmlvdXNQYWdlKG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaCh7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgbWV0YToge1xuICAgICAgICBmZXRjaE1vcmU6IHsgZGlyZWN0aW9uOiBcImJhY2t3YXJkXCIgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGNyZWF0ZVJlc3VsdChxdWVyeSwgb3B0aW9ucykge1xuICAgIGNvbnN0IHsgc3RhdGUgfSA9IHF1ZXJ5O1xuICAgIGNvbnN0IHJlc3VsdCA9IHN1cGVyLmNyZWF0ZVJlc3VsdChxdWVyeSwgb3B0aW9ucyk7XG4gICAgY29uc3QgeyBpc0ZldGNoaW5nLCBpc1JlZmV0Y2hpbmcgfSA9IHJlc3VsdDtcbiAgICBjb25zdCBpc0ZldGNoaW5nTmV4dFBhZ2UgPSBpc0ZldGNoaW5nICYmIHN0YXRlLmZldGNoTWV0YT8uZmV0Y2hNb3JlPy5kaXJlY3Rpb24gPT09IFwiZm9yd2FyZFwiO1xuICAgIGNvbnN0IGlzRmV0Y2hpbmdQcmV2aW91c1BhZ2UgPSBpc0ZldGNoaW5nICYmIHN0YXRlLmZldGNoTWV0YT8uZmV0Y2hNb3JlPy5kaXJlY3Rpb24gPT09IFwiYmFja3dhcmRcIjtcbiAgICByZXR1cm4ge1xuICAgICAgLi4ucmVzdWx0LFxuICAgICAgZmV0Y2hOZXh0UGFnZTogdGhpcy5mZXRjaE5leHRQYWdlLFxuICAgICAgZmV0Y2hQcmV2aW91c1BhZ2U6IHRoaXMuZmV0Y2hQcmV2aW91c1BhZ2UsXG4gICAgICBoYXNOZXh0UGFnZTogaGFzTmV4dFBhZ2Uob3B0aW9ucywgc3RhdGUuZGF0YSksXG4gICAgICBoYXNQcmV2aW91c1BhZ2U6IGhhc1ByZXZpb3VzUGFnZShvcHRpb25zLCBzdGF0ZS5kYXRhKSxcbiAgICAgIGlzRmV0Y2hpbmdOZXh0UGFnZSxcbiAgICAgIGlzRmV0Y2hpbmdQcmV2aW91c1BhZ2UsXG4gICAgICBpc1JlZmV0Y2hpbmc6IGlzUmVmZXRjaGluZyAmJiAhaXNGZXRjaGluZ05leHRQYWdlICYmICFpc0ZldGNoaW5nUHJldmlvdXNQYWdlXG4gICAgfTtcbiAgfVxufTtcbmV4cG9ydCB7XG4gIEluZmluaXRlUXVlcnlPYnNlcnZlclxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZmluaXRlUXVlcnlPYnNlcnZlci5qcy5tYXAiLCJcInVzZSBjbGllbnRcIjtcblxuLy8gc3JjL3VzZUluZmluaXRlUXVlcnkudHNcbmltcG9ydCB7IEluZmluaXRlUXVlcnlPYnNlcnZlciB9IGZyb20gXCJAdGFuc3RhY2svcXVlcnktY29yZVwiO1xuaW1wb3J0IHsgdXNlQmFzZVF1ZXJ5IH0gZnJvbSBcIi4vdXNlQmFzZVF1ZXJ5LmpzXCI7XG5mdW5jdGlvbiB1c2VJbmZpbml0ZVF1ZXJ5KG9wdGlvbnMsIHF1ZXJ5Q2xpZW50KSB7XG4gIHJldHVybiB1c2VCYXNlUXVlcnkoXG4gICAgb3B0aW9ucyxcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVubmVjZXNzYXJ5LXR5cGUtYXNzZXJ0aW9uXG4gICAgSW5maW5pdGVRdWVyeU9ic2VydmVyLFxuICAgIHF1ZXJ5Q2xpZW50XG4gICk7XG59XG5leHBvcnQge1xuICB1c2VJbmZpbml0ZVF1ZXJ5XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXNlSW5maW5pdGVRdWVyeS5qcy5tYXAiLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBSZXN1bHQgfSBmcm9tICcuLi90eXBlcy9ibG9nJztcclxuaW1wb3J0IHsgTGluayB9IGZyb20gJ3JlYWN0LXJvdXRlci1kb20nO1xyXG5cclxuXHJcbmludGVyZmFjZSBCbG9nTGlzdFByb3BzIHtcclxuICAgIGJsb2dzOiBSZXN1bHRbXTtcclxuICAgIHNlYXJjaD86IFJlc3VsdFtdIHwgbnVsbDtcclxufVxyXG5cclxuY29uc3QgQmxvZ0xpc3Q6IFJlYWN0LkZDPEJsb2dMaXN0UHJvcHM+ID0gKHsgYmxvZ3Msc2VhcmNoICB9KSA9PiB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIDw+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb3dcIj5cclxuICAgICAgICAgICAge3NlYXJjaCAmJiBzZWFyY2gubGVuZ3RoID09PSAwICYmIDxoMz5ObyBzZSBlbmNvbnRyYXJvbiByZXN1bHRhZG9zPC9oMz59XHJcbiAgICAgICAgICAgIHtzZWFyY2ggJiYgc2VhcmNoLmxlbmd0aCA+IDAgJiYgPGgzPlJlc3VsdGFkb3MgZGUgbGEgYsO6c3F1ZWRhPC9oMz59XHJcbiAgICAgICAgICAgIHtzZWFyY2ggJiZcclxuICAgICAgICAgICAgICAgIHNlYXJjaD8ubWFwKChibG9nKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBrZXk9e2Jsb2cuaWR9IGNsYXNzTmFtZT1cImNvbC1sZy00IGNvbC1tZC00IGNvbC1zbS02IFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TGluayB0bz17YC9ibG9nLyR7YmxvZy5pZH1gfSBjbGFzc05hbWU9J2xpbmstYmxvZ3MnPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZCBjYXJkLWJsb2cgbXQtMyBzbWFsbC1jYXJkXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY2FyZC1pbWctdG9wXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz17YmxvZy5pbWFnZX0gY2xhc3NOYW1lPVwiaW1nLWZsdWlkIHNtYWxsLWltYWdlXCIgYWx0PXtibG9nLnRpdGxlfSAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLWJvZHlcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNSBjbGFzc05hbWU9XCJjYXJkLXRpdGxlXCI+e2Jsb2cudGl0bGV9PC9oNT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImNhcmQtdGV4dFwiPntibG9nLmRlc2NyaXB0aW9uLnNsaWNlKDAsIDIwMCl9Li4uPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGluaz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHtzZWFyY2ggJiYgc2VhcmNoLmxlbmd0aCA+IDAgJiYgXHJcbiAgICAgICAgICAgIDxociBjbGFzc05hbWU9J210LTUnLz59XHJcbiAgICAgICAgICAgIFxyXG5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJvd1wiPlxyXG4gICAgICAgICAgICB7YmxvZ3MubWFwKChibG9nKSA9PiB7XHJcbiAgICBsZXQgc2l6ZUNsYXNzID0gJyc7XHJcbiAgICBsZXQgaW1hZ2VDbGFzcyA9ICcnO1xyXG4gICAgbGV0IGNhcmRDbGFzcyA9ICcnO1xyXG4gICAgaWYgKGJsb2cuaW1wb3J0YW50ID09PSBmYWxzZSkge1xyXG4gICAgICAgIHNpemVDbGFzcyA9ICdjb2wtbGctNCBjb2wtbWQtNCBjb2wtc20tNic7IC8vIFByaW1lcmEgdGFyamV0YSBwZXF1ZcOxYVxyXG4gICAgICAgIGNhcmRDbGFzcyA9ICdzbWFsbC1jYXJkJztcclxuICAgICAgICBpbWFnZUNsYXNzID0gJ3NtYWxsLWltYWdlJztcclxuICAgIH0gZWxzZSBpZiAoYmxvZy5pbXBvcnRhbnQgPT09IHRydWUpIHtcclxuICAgICAgICBzaXplQ2xhc3MgPSAnY29sLWxnLTYgY29sLW1kLTEyIGNvbC1zbS0xMiAnOyAvLyBTZWd1bmRhIHRhcmpldGEgMyB2ZWNlcyBtw6FzIGdyYW5kZVxyXG4gICAgICAgIGltYWdlQ2xhc3MgPSAnYmlnLWltYWdlJztcclxuICAgICAgICBjYXJkQ2xhc3MgPSAnYmlnLWNhcmQnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzaXplQ2xhc3MgPSAnY29sLWxnLTMgY29sLW1kLTQgY29sLXNtLTYnOyAvLyBSZXN0byBkZSB0YXJqZXRhcyBwZXF1ZcOxYXNcclxuICAgICAgICBpbWFnZUNsYXNzID0gJ3NtYWxsLWltYWdlJztcclxuICAgICAgICBjYXJkQ2xhc3MgPSAnc21hbGwtY2FyZCc7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICAgIDxkaXYga2V5PXtibG9nLmlkfSBjbGFzc05hbWU9e3NpemVDbGFzc30+XHJcbiAgICAgICAgICAgIDxMaW5rIHRvPXtgL2Jsb2cvJHtibG9nLmlkfWB9IGNsYXNzTmFtZT0nbGluay1ibG9ncyc+XHJcbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17YGNhcmQgY2FyZC1ibG9nIG10LTMgJHtjYXJkQ2xhc3N9YH0+XHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjYXJkLWltZy10b3BcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9e2Jsb2cuaW1hZ2V9IGNsYXNzTmFtZT17YCBpbWctZmx1aWQgJHtpbWFnZUNsYXNzfWB9IGFsdD17YmxvZy50aXRsZX0gLz5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNhcmQtYm9keVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aDUgY2xhc3NOYW1lPVwiY2FyZC10aXRsZVwiPntibG9nLnRpdGxlfTwvaDU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cImNhcmQtdGV4dFwiPntibG9nLmRlc2NyaXB0aW9uLnNsaWNlKDAsIDIwMCl9Li4uPC9wPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvTGluaz5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICk7XHJcbn0pfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgPC8+XHJcbiAgICApO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgQmxvZ0xpc3Q7IiwiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgRmlTZWFyY2ggfSBmcm9tICdyZWFjdC1pY29ucy9maSc7XG5cbnR5cGUgU2VhcmNoUHJvcHMgPSB7XG4gICAgc2V0RmlsdGVyOiAoZmlsdGVyOiBzdHJpbmcpID0+IHZvaWQ7XG59O1xuXG5jb25zdCBTZWFyY2g6IFJlYWN0LkZDPFNlYXJjaFByb3BzPiA9ICh7IHNldEZpbHRlciB9KSA9PiB7XG4gICAgY29uc3QgW3NlYXJjaFZhbHVlLCBzZXRTZWFyY2hWYWx1ZV0gPSB1c2VTdGF0ZSgnJyk7XG5cbiAgICBjb25zdCBoYW5kbGVTZWFyY2hDaGFuZ2UgPSAoZXZlbnQ6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIHNldFNlYXJjaFZhbHVlKGV2ZW50LnRhcmdldC52YWx1ZSk7XG4gICAgICAgIHNldEZpbHRlcihldmVudC50YXJnZXQudmFsdWUpO1xuICAgIH07XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICAgIHZhbHVlPXtzZWFyY2hWYWx1ZX1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlU2VhcmNoQ2hhbmdlfVxuICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQnVzY2FyLi4uXCJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9J2Jsb2ctc2VhcmNoJ1xuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDxGaVNlYXJjaCBjbGFzc05hbWU9XCJtcy0yXCIgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFNlYXJjaDsiLCJpbXBvcnQgeyB1c2VJbmZpbml0ZVF1ZXJ5IH0gZnJvbSAnQHRhbnN0YWNrL3JlYWN0LXF1ZXJ5JztcbmNvbnN0IFNwaW5uZXIgPSBSZWFjdC5sYXp5KCgpID0+IGltcG9ydCgnLi4vY29tcG9uZW50cy9zcGlubmVyJykpO1xuaW1wb3J0IHsgdXNlRWZmZWN0LCB1c2VTdGF0ZX0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgUmVzdWx0IH0gZnJvbSAnLi4vdHlwZXMvYmxvZyc7XG5pbXBvcnQgeyBmZXRjaE5leHRCbG9ncyxmZXRjaEJsb2dTZWFyY2ggfSBmcm9tICcuLi9hcGkvYmxvZyc7XG5pbXBvcnQgXCIuLi9wYWdlcy9zdHlsZXMvYmxvZ3MuY3NzXCJcbmltcG9ydCBCbG9nTGF5b3V0IGZyb20gJy4uL2xheW91dHMvYmxvZ0xheW91dCc7XG5pbXBvcnQgQmxvZ0xpc3QgZnJvbSAnLi4vY29tcG9uZW50cy9ibG9nQ2FyZHMnO1xuaW1wb3J0IFNpZGViYXIgZnJvbSAnLi4vY29tcG9uZW50cy9zaWRlYmFyQm9sZ3MnO1xuaW1wb3J0IEJsb2dTZWFyY2ggZnJvbSAnLi4vY29tcG9uZW50cy9zZWFyY2gnO1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB1c2VJbnRlcnNlY3Rpb25PYnNlcnZlciBmcm9tICcuLi9ob29rcy91c2VMYXp5bG9hZCc7XG5cbmNvbnN0IEJsb2cgPSAgKCkgPT4ge1xuICAgIGNvbnN0IFtmaWx0ZXIsIHNldEZpbHRlcl0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgICBjb25zdCBbZmlsdGVyQmxvZ3MsIHNldEZpbHRlckJsb2dzdF0gPSB1c2VTdGF0ZTxSZXN1bHRbXSB8IG51bGw+KG51bGwpO1xuICAgIGNvbnN0IHsgZGF0YSwgaXNFcnJvciwgaXNMb2FkaW5nLCBmZXRjaE5leHRQYWdlLGhhc05leHRQYWdlLGlzRmV0Y2hpbmdOZXh0UGFnZSB9ID0gdXNlSW5maW5pdGVRdWVyeShcbiAgICAgICAge1xuICAgICAgICAgIHF1ZXJ5S2V5OiBbJ2Jsb2dzJ10sXG4gICAgICAgICAgcXVlcnlGbjogKHsgcGFnZVBhcmFtID0gMCB9KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZmV0Y2hOZXh0QmxvZ3MocGFnZVBhcmFtKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGluaXRpYWxQYWdlUGFyYW06ICcxJyxcbiAgICAgICAgICBzdGFsZVRpbWU6IDEwMDAqNjAqMzAscmVmZXRjaE9uV2luZG93Rm9jdXM6IGZhbHNlLHJlZmV0Y2hJbnRlcnZhbDogMTAwMCo2MCozMCxcbiAgICAgICAgICBnZXROZXh0UGFnZVBhcmFtOiAobGFzdFBhZ2UpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGxhc3RQYWdlLCAnbGFzdFBhZ2UnKTtcbiAgICAgICAgICAgIGlmIChsYXN0UGFnZT8ubmV4dFBhZ2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsYXN0UGFnZS5uZXh0UGFnZSwgJ2xhc3RQYWdlLm5leHRQYWdlJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHJldHVybiBsYXN0UGFnZS5uZXh0UGFnZS5zcGxpdCgnPScpWzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIWZpbHRlcikgcmV0dXJuO1xuICAgICAgICBjb25zdCBmZXRjaERhdGEgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoQmxvZ1NlYXJjaChmaWx0ZXIpO1xuICAgICAgICAgICAgaWYgKCFyZXNwb25zZSkgcmV0dXJuO1xuICAgICAgICAgICAgc2V0RmlsdGVyQmxvZ3N0KHJlc3BvbnNlKTtcbiAgICAgICAgfTtcbiAgICAgICAgZmV0Y2hEYXRhKCk7XG4gICAgfSwgW2ZpbHRlcl0pO1xuXG4gICAgICBcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIWRhdGEpIHJldHVybjtcbiAgICAgICAgaWYgKGRhdGEucGFnZXNbMF0gKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhLnBhZ2VzWzBdLmJsb2dzLCAnZGF0YS5wYWdlc1swXS5ibG9ncycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBzZXRDb3VudChkYXRhLnBhZ2VzWzBdLmJsb2dzKTtcbiAgICAgICAgfVxuICAgIH0sIFtdKTtcbiAgICBpZiAoaXNFcnJvcikge1xuICAgICAgICByZXR1cm4gPGRpdj5FcnJvcjwvZGl2PjtcbiAgICB9XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgICByZXR1cm4gPFNwaW5uZXIgLz47XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKGRhdGEsICdkYXRhJyk7XG4gICAgaWYgKCFkYXRhKSB7XG4gICAgICAgIHJldHVyblxuICAgICAgICBcbiAgICB9XG4gICAgY29uc3QgYmxvZ3M6IFJlc3VsdFtdID0gZGF0YS5wYWdlcy5mbGF0TWFwKChwYWdlKSA9PiBwYWdlPy5ibG9ncyA/PyBbXSk7XG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J2Jsb2ctY29udGFpbmVyIHB0LTMnPlxuICAgICAgICAgICAgPEJsb2dMYXlvdXQ+IFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGFpbmVyLWZsdWlkXCI+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmxvZy1oZWFkZXIgIHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8aDE+TWFnbmFCbG9nPC9oMT5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiIHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8QmxvZ1NlYXJjaCBzZXRGaWx0ZXI9e3NldEZpbHRlcn0gLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmxvZy1jYXJkcyBcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm93XCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtbGctOCBjb2wtMTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJsb2dMaXN0IGJsb2dzPXtibG9nc30gc2VhcmNoPXtmaWx0ZXJCbG9nc30gLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC1tZC00IGNvbC0xMlwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8U2lkZWJhciAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGZldGNoTmV4dFBhZ2UoKX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiYnRuIGJ0bi1wcmltYXJ5XCJcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cImJ1dHRvblwiXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshaGFzTmV4dFBhZ2UgfHwgaXNGZXRjaGluZ05leHRQYWdlfVxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBtYXJnaW5Ub3A6ICcycmVtJyB9fVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAge2lzRmV0Y2hpbmdOZXh0UGFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgPyAnTG9hZGluZyBtb3JlLi4uJ1xuICAgICAgICAgICAgICAgICAgICAgICAgOiBoYXNOZXh0UGFnZVxuICAgICAgICAgICAgICAgICAgICAgICAgPyAnQ2FyZ2FyIG3DoXMgYmxvZ3MnXG4gICAgICAgICAgICAgICAgICAgICAgICA6ICdObyBoYXkgbcOhcyBibG9ncyd9XG4gICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9CbG9nTGF5b3V0PlxuICAgICAgICA8L2Rpdj5cbiAgICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gTGF6eUJsb2coKSB7XG4gICAgY29uc3QgeyAgaXNWaXNpYmxlLCByZWYgfSA9IHVzZUludGVyc2VjdGlvbk9ic2VydmVyKCcxMDBweCcpO1xuICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYgaWQ9XCJMYXp5QmxvZ1wiIHJlZj17cmVmfT5cbiAgICAgICAgICAgIHtpc1Zpc2libGUgPyA8QmxvZyAvPiA6IG51bGx9XG4gICAgICAgIDwvZGl2PlxuICAgICk7XG59XG5cblxuICAgIFxuIl0sImZpbGUiOiJhc3NldHMvYmxvZy1jYWVjZmZjMC5qcyJ9