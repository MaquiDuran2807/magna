import{Q as N,x,y as j,z as v,B as p,j as e,L as f,r as d,C as P}from"./index-e17badfe.js";import{B as b,S as y,f as B,a as S}from"./sidebarBolgs-65d60574.js";import{a as F}from"./index.esm-857cf632.js";import"./index.esm-2cc31e9b.js";var M=class extends N{constructor(a,s){super(a,s)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(a,s){super.setOptions({...a,behavior:x()},s)}getOptimisticResult(a){return a.behavior=x(),super.getOptimisticResult(a)}fetchNextPage(a){return this.fetch({...a,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(a){return this.fetch({...a,meta:{fetchMore:{direction:"backward"}}})}createResult(a,s){var n,o,g,r;const{state:t}=a,c=super.createResult(a,s),{isFetching:i,isRefetching:l}=c,h=i&&((o=(n=t.fetchMeta)==null?void 0:n.fetchMore)==null?void 0:o.direction)==="forward",m=i&&((r=(g=t.fetchMeta)==null?void 0:g.fetchMore)==null?void 0:r.direction)==="backward";return{...c,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:j(s,t.data),hasPreviousPage:v(s,t.data),isFetchingNextPage:h,isFetchingPreviousPage:m,isRefetching:l&&!h&&!m}}};function w(a,s){return p(a,M,s)}const C=({blogs:a,search:s})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",children:[s&&s.length===0&&e.jsx("h3",{children:"No se encontraron resultados"}),s&&s.length>0&&e.jsx("h3",{children:"Resultados de la búsqueda"}),s&&(s==null?void 0:s.map(t=>e.jsx("div",{className:"col-lg-4 col-md-4 col-sm-6 ",children:e.jsx(f,{to:`/blog/${t.id}`,className:"link-blogs",children:e.jsxs("div",{className:"card card-blog mt-3 small-card",children:[e.jsx("div",{className:"card-img-top",children:e.jsx("img",{src:t.image,className:"img-fluid small-image",alt:t.title})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:t.title}),e.jsxs("p",{className:"card-text",children:[t.description.slice(0,200),"..."]})]})]})})},t.id))),s&&s.length>0&&e.jsx("hr",{className:"mt-5"})]}),e.jsx("div",{className:"row",children:a.map(t=>{let c="",i="",l="";return t.important===!1?(c="col-lg-4 col-md-4 col-sm-6",l="small-card",i="small-image"):t.important===!0?(c="col-lg-6 col-md-12 col-sm-12 ",i="big-image",l="big-card"):(c="col-lg-3 col-md-4 col-sm-6",i="small-image",l="small-card"),e.jsx("div",{className:c,children:e.jsx(f,{to:`/blog/${t.id}`,className:"link-blogs",children:e.jsxs("div",{className:`card card-blog mt-3 ${l}`,children:[e.jsx("div",{className:"card-img-top",children:e.jsx("img",{src:t.image,className:` img-fluid ${i}`,alt:t.title})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:t.title}),e.jsxs("p",{className:"card-text",children:[t.description.slice(0,200),"..."]})]})]})})},t.id)})})]}),R=({setFilter:a})=>{const[s,t]=d.useState(""),c=i=>{t(i.target.value),a(i.target.value)};return e.jsxs("div",{children:[e.jsx("input",{type:"text",value:s,onChange:c,placeholder:"Buscar...",className:"blog-search"}),e.jsx(F,{className:"ms-2"})]})},Q=()=>{const[a,s]=d.useState(""),[t,c]=d.useState(null),{data:i,isError:l,isLoading:h,fetchNextPage:m,hasNextPage:n,isFetchingNextPage:o}=w({queryKey:["blogs"],queryFn:({pageParam:r=0})=>S(r),initialPageParam:"1",staleTime:1e3*60*30,refetchOnWindowFocus:!1,refetchInterval:1e3*60*30,getNextPageParam:r=>{if(console.log(r,"lastPage"),r!=null&&r.nextPage)return console.log(r.nextPage,"lastPage.nextPage"),r.nextPage.split("=")[1]}});if(d.useEffect(()=>{if(!a)return;(async()=>{const u=await B(a);u&&c(u)})()},[a]),d.useEffect(()=>{i&&i.pages[0]&&console.log(i.pages[0].blogs,"data.pages[0].blogs")},[]),l)return e.jsx("div",{children:"Error"});if(h)return e.jsx(P,{});if(console.log(i,"data"),!i)return;const g=i.pages.flatMap(r=>(r==null?void 0:r.blogs)??[]);return e.jsx("div",{className:"blog-container pt-3",children:e.jsx(b,{children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"blog-header  text-center",children:e.jsx("h1",{children:"MagnaBlog"})}),e.jsx("div",{className:" text-center",children:e.jsx(R,{setFilter:s})}),e.jsxs("div",{className:"blog-cards ",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-8 col-12",children:e.jsx(C,{blogs:g,search:t})}),e.jsx("div",{className:"col-md-4 col-12",children:e.jsx(y,{})})]}),e.jsx("button",{onClick:()=>m(),className:"btn btn-primary",type:"button",disabled:!n||o,style:{marginTop:"2rem"},children:o?"Loading more...":n?"Cargar más blogs":"No hay más blogs"})]})]})})})};export{Q as default};
