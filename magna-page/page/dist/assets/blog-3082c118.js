import{Q as u,v as m,w as x,x as f,y as N,j as e,L as P,r as p,z as v}from"./index-303d19a8.js";import{a as j}from"./index.esm-a15e2317.js";import{B as b,S as y,f as M}from"./sidebarBolgs-e0a3b7e3.js";import"./index.esm-79e577db.js";var B=class extends u{constructor(s,t){super(s,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(s,t){super.setOptions({...s,behavior:m()},t)}getOptimisticResult(s){return s.behavior=m(),super.getOptimisticResult(s)}fetchNextPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"backward"}}})}createResult(s,t){var o,d,h,g;const{state:r}=s,c=super.createResult(s,t),{isFetching:i,isRefetching:l}=c,n=i&&((d=(o=r.fetchMeta)==null?void 0:o.fetchMore)==null?void 0:d.direction)==="forward",a=i&&((g=(h=r.fetchMeta)==null?void 0:h.fetchMore)==null?void 0:g.direction)==="backward";return{...c,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:x(t,r.data),hasPreviousPage:f(t,r.data),isFetchingNextPage:n,isFetchingPreviousPage:a,isRefetching:l&&!n&&!a}}};function w(s,t){return N(s,B,t)}const F=({blogs:s})=>e.jsx("div",{className:"row",children:s.map(t=>{let r="",c="",i="";return t.important===!1?(r="col-lg-4 col-md-4 col-sm-6",i="small-card",c="small-image"):t.important===!0?(r="col-lg-6 col-md-12 col-sm-12 ",c="big-image",i="big-card"):(r="col-lg-3 col-md-4 col-sm-6",c="small-image",i="small-card"),e.jsx("div",{className:r,children:e.jsx(P,{to:`/blog/${t.id}`,className:"link-blogs",children:e.jsxs("div",{className:`card card-blog mt-3 ${i}`,children:[e.jsx("img",{src:t.image,className:`card-img-top img-fluid ${c}`,alt:t.title}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:t.title}),e.jsxs("p",{className:"card-text",children:[t.description.slice(0,200),"..."]})]})]})})},t.id)})}),k=()=>{const{data:s,isError:t,isLoading:r,fetchNextPage:c,hasNextPage:i,isFetchingNextPage:l}=w({queryKey:["blogs"],queryFn:({pageParam:a=0})=>M(a),initialPageParam:"1",staleTime:18e5,refetchOnWindowFocus:!1,refetchInterval:18e5,getNextPageParam:a=>{if(console.log(a,"lastPage"),a!=null&&a.nextPage)return console.log(a.nextPage,"lastPage.nextPage"),a.nextPage.split("=")[1]}});if(p.useEffect(()=>{s&&s.pages[0]&&console.log(s.pages[0].blogs,"data.pages[0].blogs")},[]),t)return e.jsx("div",{children:"Error"});if(r)return e.jsx(v,{});if(console.log(s,"data"),!s)return;const n=s.pages.flatMap(a=>(a==null?void 0:a.blogs)??[]);return e.jsx("div",{className:"blog-container pt-3",children:e.jsx(b,{children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"blog-header  text-center",children:e.jsx("h1",{children:"MagnaBlog"})}),e.jsxs("div",{className:" text-center",children:[e.jsx("input",{type:"text",placeholder:"Buscar",className:"blog-search"}),e.jsx(j,{className:"ms-2"})]}),e.jsxs("div",{className:"blog-cards ",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-9 col-12",children:e.jsx(F,{blogs:n})}),e.jsx("div",{className:"col-md-3",children:e.jsx(y,{})})]}),e.jsx("button",{onClick:()=>c(),className:"btn btn-primary",type:"button",disabled:!i||l,style:{marginTop:"2rem"},children:l?"Loading more...":i?"Cargar más blogs":"No hay más blogs"})]})]})})})};export{k as default};
